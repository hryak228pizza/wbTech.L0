# L0. Order service
Демонстрационный сервис с простейшим интерфейсом, отображающий данные о заказе. 
## Запуск
1. Скопируйте репозиторий
```shell
git clone github.com/hryak228pizza/wbTech.L0
```
2. В корне проекта у Вас должен быть файл .env. Установите в него необходимые для Вас параметры. Используйте .env.template как пример
3. Запустите контейнер
```shell
docker compose up -d
```
4. Находясь в корневой папке проекта выполните
```shell
go run ./cmd/main.go
```
5. Вы можете ознакомиться с документацией по пути
```shell
/swagger/
```
## Архитектура
В проекте используется следующий стек технологий:
- __Go__
- __html/js__
- __kafka__
- __postgreSQL__
- __swagger__
***
На веб странице в поле ввода вводится Id заказа. После нажатия кнопки Get срабатывает обработчик, который отправляет get запрос на /order/{id}.   
Когда на наш сервис приходит get запрос, сервис возвращает json этого заказа, причем делает это разными способами: если id заказа есть в кэше - берет оттуда, иначе - идет в БД и подтягивает данные уже из нее, при этом этот заказ помещается в кэш. При успехе возвращается json c кодом 200, иначе 404 в случае, если заказа такого нет.   
Параллельно с этим приходят заказы в брокер. Сервис их читает, проверяет на валидность, сохраняет новый заказ в кэш и в БД.   

## Структура проекта
- __./cmd/main.go__ - точка входа.
- __./internal/generator__ - генератор заказов. Используется для продюсера брокера как симуляция новых заказов, которые создают пользователи.
- __./internal/infrastucture__ - миграции и запросы для базы данных.
- __./internal/logger__ - реализация логгера через go.uber.org/zap.
- __./internal/model__ - модель данных заказа.
- __./internal/transport/handler__ - реализация обработчика запросов на сервисе по эндпоинтам "/" и "/order/". Здесь же папка с документацией, сгенерированной при помощи swagger.
- __./internal/transport/kafka__ - реализация продюсера и консьюмера брокера.
- __./pkg/cache__ - реализация кеша при помощи github.com/hashicorp/golang-lru.
- __./pkg/validation__ - реализация валидатора данных при помощи github.com/go-playground/validator.
- __./templates__ - шаблон для веб-страниц.

## Что изменилось?
- Прогнал проект через goimports
- Больше нет необрабатываемых ошибок
- 
